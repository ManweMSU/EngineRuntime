<html>
    <head>
        <meta charset="UTF-8">
        <title>Спецификация формата сериализации Engine Runtime</title>
    </head>
    <body style="font-family: 'Courier New', Courier, monospace">
        <h1>Спецификация формата сериализации Engine Runtime</h1>
        <i>
            Данная спецификация поставляется вместе с Engine Runtime для ознакомления со стандартами особых форматов, в нём используемых.
            Спецификация не предназначена для самостоятельной разработки кодирующего/декодирующего ПО,
            Engine Software не несёт никакой ответственности за последствия такого рода самодеятельности.<br>
            Copyright &COPY; Engine Software, Емельянов Д. П. 2019.<br><br>
        </i>
<h2>Объект. Корневой объект находится по смещению 0. Остальные доступны по ссылкам.</h2>
<table border="1">
    <tr><td><b>Имя поля</b></td><td><b>Размер в байтах</b></td><td><b>Значение</b></td></tr>
    <tr><td>PropertyCount</td><td>4</td><td>Количество устанавливаемых значений.</td></tr>
    <tr><td>PropertyHeaders</td><td>16 * PropertyCount</td><td>Записи, описывающие конкретные свойства объекта (см. Заголовок свойства).</td></tr>
</table>
<h2>Заголовок свойства.</h2>
<table border="1">
    <tr><td><b>Имя поля</b></td><td><b>Размер в байтах</b></td><td><b>Значение</b></td></tr>
    <tr><td>PropertyName</td><td>4</td><td>Адрес строки UTF8 с именем свойства.</td></tr>
    <tr><td>PropertyType</td><td>4</td><td>Тип свойства. В случае массива - тип элемента массива.</td></tr>
    <tr><td>PropertyVolume</td><td>4</td><td>Количество элементов в массиве или 0, если свойство не является массивом.</td></tr>
    <tr><td>PropertyValue</td><td>4</td><td>Адрес значения свойства.</td></tr>
</table>
<p>
    Формат значения свойства: для почти всех типов указывается адрес актуального значения.
    Для строк - адрес их значения в кодировке UTF8, для структур - адрес описателя структуры.
    В случае массива для всех типов кроме указанных двух исключений, адрес значения указывает на массив фактических значений.
    Для типов - исключений массив состоит из адресов актуальных значений.
</p>
        <h1>Дополнение формата для сохранения в виде файла:</h1>
        <p>
            Рекомендуемое расширение: ecso.
        </p>
        <h2>Структура файла.</h2>
<table border="1">
    <tr><td><b>Имя поля</b></td><td><b>Размер в байтах</b></td><td><b>Значение</b></td></tr>
    <tr><td>Signature</td><td>8</td><td>"eobject\0" - подпись файла.</td></tr>
    <tr><td>Version</td><td>4</td><td>0 - версия формата.</td></tr>
    <tr><td>Size</td><td>4</td><td>Размер сериализованного объекта.</td></tr>
    <tr><td>Object</td><td>Size</td><td>Непосредственно объект.</td></tr>
</table>
    </body>
</html>